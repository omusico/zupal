package game{	import flash.display.MovieClip;	import flash.events.Event;	import flash.ui.Mouse;	import flash.events.MouseEvent;	import Synerg;	import game.synerg.tiles.*;	import game.synerg.*;	import game.synerg.buttons.Ranch;	public class Game extends MovieClip {		//--->  Game control		public function start():void {			addEventListener(Event.ENTER_FRAME,update,false,0,true);			new_farm_btn.addEventListener(MouseEvent.MOUSE_DOWN, add_farm);			// Mouse.hide();			// Add graphics			create_enviroment();		}		public function pause():void {			removeEventListener(Event.ENTER_FRAME,update);		}		//--->  Graphics control		private function create_enviroment():void {			trace('creating environment');			bg.x=Synerg.BOARD_X;			bg.y=Synerg.BOARD_Y;			addChild(bg);			new_ranch_btn=new Ranch(this);			new_farm_btn.x=5;			new_farm_btn.y=25;			new_ranch_btn.x=5;			new_ranch_btn.y=80;			addChild(new_farm_btn);			addChild(new_ranch_btn);		}		private function update(e:Event):void {			t++;			var n:MovieClip;			if (n=Synerg.new_piece) {				n.drag();			}			Synerg.being_map.update(t);			if (n && (!(t % 50))) {				trace("time = " + t);				trace("PIECE x = " + n.x + ", y = " + n.y);				trace("PIECE i = " + n.get_i() + ", j = " + n.get_j());			}			Synerg.being_map.reshuffle();		}		private function add_farm(e: Event) {			if (Synerg.new_piece) {				return;			}			trace("adding farm");			var zone_layer:MovieClip = get_layer("zones");			Synerg.new_piece = new Farm_tile();			Synerg.new_piece.x=0;			Synerg.new_piece.y=0;			zone_layer.addChild(Synerg.new_piece);			addEventListener(MouseEvent.MOUSE_UP, drop_piece);		}		public function add_ranch() {			if (Synerg.new_piece) {				return;			}			trace("adding ranch");			var zone_layer:MovieClip = get_layer("zones");			Synerg.new_piece = new Ranch_tile();			Synerg.new_piece.x=0;			Synerg.new_piece.y=0;			zone_layer.addChild(Synerg.new_piece);			addEventListener(MouseEvent.MOUSE_UP, drop_piece);		}		private function drop_piece(e: Event) {			trace("dropping piece");			if (Synerg.new_piece) {				Synerg.new_piece.place();				Synerg.new_piece=null;			} else {				trace('(no piece found)');			}			// @TODO -- detect overlap			removeEventListener(MouseEvent.MOUSE_UP, drop_piece);		}		private var t:int;		//private var p:player=new player;		private var bg:MovieClip=new Terrain();		private var new_farm_btn = new new_farm_btn_gfx();		private var new_ranch_btn:Ranch;				public function get_layer(layer_name : String) {			return bg.getChildByName(layer_name);		}	}}